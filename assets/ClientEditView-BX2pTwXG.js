import{d as I,E as M,r as U,O as k,a as y,L as q,s as T,c as m,e as r,f as o,w as i,_ as b,k as u,g,l as v,N as G,i as x,P as S,t as _,H as F,I as O,h as L,x as p}from"./index-N1mcpD2Q.js";import{_ as j}from"./BaseCard.vue_vue_type_script_setup_true_lang-BddG5p4d.js";import{_ as d}from"./BaseInput.vue_vue_type_script_setup_true_lang-CiqAZZOo.js";import{V as J}from"./viacep-service-DicvFmrq.js";const H={class:"space-y-6"},Z={class:"md:flex md:items-center md:justify-between"},K={class:"mt-4 flex md:mt-0 md:ml-4"},Q={class:"grid grid-cols-1 gap-6 sm:grid-cols-2"},W={class:"grid grid-cols-1 gap-6 sm:grid-cols-2"},X={class:"grid grid-cols-1 gap-6 sm:grid-cols-2"},Y={key:0,class:"mt-1 text-sm text-red-600"},ee={class:"border-t border-gray-200 pt-6"},ae={class:"grid grid-cols-1 gap-6 sm:grid-cols-2"},le={class:"grid grid-cols-1 gap-6 sm:grid-cols-2 mt-6"},se={key:0,class:"mt-1 text-sm text-red-600"},te={class:"grid grid-cols-1 gap-6 sm:grid-cols-1 mt-6"},re={class:"flex justify-end space-x-3 pt-6 border-t border-gray-200"},me=I({__name:"ClientEditView",setup(oe){const c=T(),E=k(),h=M(),n=U(!1),C=E.params.id,e=y({name:"",lastName:"",cpf:"",phone:"",email:"",status:"",address:{zipCode:"",street:"",neighborhood:"",city:"",state:""}}),s=y({name:"",lastName:"",cpf:"",phone:"",email:"",status:"",address:{zipCode:"",street:"",neighborhood:"",city:"",state:""}}),N=[{value:"AC",label:"Acre"},{value:"AL",label:"Alagoas"},{value:"AP",label:"Amapá"},{value:"AM",label:"Amazonas"},{value:"BA",label:"Bahia"},{value:"CE",label:"Ceará"},{value:"DF",label:"Distrito Federal"},{value:"ES",label:"Espírito Santo"},{value:"GO",label:"Goiás"},{value:"MA",label:"Maranhão"},{value:"MT",label:"Mato Grosso"},{value:"MS",label:"Mato Grosso do Sul"},{value:"MG",label:"Minas Gerais"},{value:"PA",label:"Pará"},{value:"PB",label:"Paraíba"},{value:"PR",label:"Paraná"},{value:"PE",label:"Pernambuco"},{value:"PI",label:"Piauí"},{value:"RJ",label:"Rio de Janeiro"},{value:"RN",label:"Rio Grande do Norte"},{value:"RS",label:"Rio Grande do Sul"},{value:"RO",label:"Rondônia"},{value:"RR",label:"Roraima"},{value:"SC",label:"Santa Catarina"},{value:"SP",label:"São Paulo"},{value:"SE",label:"Sergipe"},{value:"TO",label:"Tocantins"}];q(async()=>{await P()});async function P(){try{n.value=!0;const a=await h.getClientById(C);a?(e.name=a.name,e.lastName=a.lastName,e.cpf=a.cpf,e.phone=a.phone,e.email=a.email,e.status=a.status,e.address.zipCode=a.address.zipCode,e.address.street=a.address.street,e.address.neighborhood=a.address.neighborhood,e.address.city=a.address.city,e.address.state=a.address.state):c.push("/clients")}catch(a){console.error("Erro ao carregar cliente:",a),c.push("/clients")}finally{n.value=!1}}function $(){s.name="",s.lastName="",s.cpf="",s.phone="",s.email="",s.status="",s.address.zipCode="",s.address.street="",s.address.neighborhood="",s.address.city="",s.address.state="";let a=!0;return e.name.trim()||(s.name="Nome é obrigatório",a=!1),e.lastName.trim()||(s.lastName="Sobrenome é obrigatório",a=!1),e.cpf.trim()?e.cpf.replace(/\D/g,"").length!==11&&(s.cpf="CPF deve ter 11 dígitos",a=!1):(s.cpf="CPF é obrigatório",a=!1),e.phone.trim()?e.phone.replace(/\D/g,"").length<10&&(s.phone="Telefone deve ter pelo menos 10 dígitos",a=!1):(s.phone="Telefone é obrigatório",a=!1),e.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.email)||(s.email="E-mail inválido",a=!1):(s.email="E-mail é obrigatório",a=!1),e.status||(s.status="Status é obrigatório",a=!1),e.address.zipCode.trim()||(s.address.zipCode="CEP é obrigatório",a=!1),e.address.street.trim()||(s.address.street="Rua é obrigatória",a=!1),e.address.neighborhood.trim()||(s.address.neighborhood="Bairro é obrigatório",a=!1),e.address.city.trim()||(s.address.city="Cidade é obrigatória",a=!1),e.address.state||(s.address.state="Estado é obrigatório",a=!1),a}function z(){let a=e.cpf.replace(/\D/g,"");a=a.substring(0,11),a=a.replace(/(\d{3})(\d)/,"$1.$2"),a=a.replace(/(\d{3})(\d)/,"$1.$2"),a=a.replace(/(\d{3})(\d{1,2})$/,"$1-$2"),e.cpf=a}function D(){let a=e.phone.replace(/\D/g,"");a=a.substring(0,11),a=a.replace(/(\d{2})(\d)/,"($1) $2"),a=a.replace(/(\d{5})(\d)/,"$1-$2"),e.phone=a}function A(){let a=e.address.zipCode.replace(/\D/g,"");a=a.substring(0,8),a=a.replace(/(\d{5})(\d)/,"$1-$2"),e.address.zipCode=a}async function R(){const a=e.address.zipCode.replace(/\D/g,"");if(a.length===8)try{const l=await J.getAddressByZipCode(a);l&&(e.address.street=l.street,e.address.neighborhood=l.neighborhood,e.address.city=l.city,e.address.state=l.state)}catch(l){console.error("Erro ao buscar CEP:",l)}}async function w(){if($())try{n.value=!0,await h.updateClient(C,{name:e.name,lastName:e.lastName,cpf:e.cpf.replace(/\D/g,""),phone:e.phone.replace(/\D/g,""),email:e.email,status:e.status,address:{zipCode:e.address.zipCode.replace(/\D/g,""),street:e.address.street,neighborhood:e.address.neighborhood,city:e.address.city,state:e.address.state}})&&c.push("/clients")}catch(a){console.error("Erro ao atualizar cliente:",a)}finally{n.value=!1}}return(a,l)=>{const B=g("el-icon"),f=g("el-option"),V=g("el-select");return p(),m("div",H,[r("div",Z,[l[14]||(l[14]=r("div",{class:"flex-1 min-w-0"},[r("h2",{class:"text-2xl font-bold leading-7 text-gray-900 sm:text-3xl sm:truncate"}," Editar Cliente "),r("p",{class:"mt-1 text-sm text-gray-500"},"Atualize as informações do cliente.")],-1)),r("div",K,[o(b,{variant:"outline",onClick:l[0]||(l[0]=t=>a.$router.push("/clients"))},{default:i(()=>[o(B,{class:"mr-2"},{default:i(()=>[o(v(G))]),_:1}),l[13]||(l[13]=u(" Voltar "))]),_:1,__:[13]})])]),o(j,null,{default:i(()=>[r("form",{onSubmit:L(w,["prevent"]),class:"space-y-6"},[r("div",Q,[o(d,{modelValue:e.name,"onUpdate:modelValue":l[1]||(l[1]=t=>e.name=t),label:"Nome",placeholder:"Digite o nome",required:"",error:s.name},null,8,["modelValue","error"]),o(d,{modelValue:e.lastName,"onUpdate:modelValue":l[2]||(l[2]=t=>e.lastName=t),label:"Sobrenome",placeholder:"Digite o sobrenome",required:"",error:s.lastName},null,8,["modelValue","error"])]),r("div",W,[o(d,{modelValue:e.cpf,"onUpdate:modelValue":l[3]||(l[3]=t=>e.cpf=t),label:"CPF",placeholder:"000.000.000-00",required:"",error:s.cpf,onInput:z},null,8,["modelValue","error"]),o(d,{modelValue:e.phone,"onUpdate:modelValue":l[4]||(l[4]=t=>e.phone=t),label:"Telefone",placeholder:"(00) 00000-0000",required:"",error:s.phone,onInput:D},null,8,["modelValue","error"])]),r("div",X,[o(d,{modelValue:e.email,"onUpdate:modelValue":l[5]||(l[5]=t=>e.email=t),type:"email",label:"E-mail",placeholder:"Digite o e-mail",required:"",error:s.email},null,8,["modelValue","error"]),r("div",null,[l[15]||(l[15]=r("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[u(" Status "),r("span",{class:"text-red-500"},"*")],-1)),o(V,{modelValue:e.status,"onUpdate:modelValue":l[6]||(l[6]=t=>e.status=t),placeholder:"Selecione o status",class:"w-full"},{default:i(()=>[o(f,{label:"Ativo",value:v(S).ACTIVE},null,8,["value"]),o(f,{label:"Inativo",value:v(S).INACTIVE},null,8,["value"])]),_:1},8,["modelValue"]),s.status?(p(),m("p",Y,_(s.status),1)):x("",!0)])]),r("div",ee,[l[17]||(l[17]=r("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Endereço",-1)),r("div",ae,[o(d,{modelValue:e.address.zipCode,"onUpdate:modelValue":l[7]||(l[7]=t=>e.address.zipCode=t),label:"CEP",placeholder:"00000-000",required:"",error:s.address?.zipCode,onInput:A,onBlur:R},null,8,["modelValue","error"]),o(d,{modelValue:e.address.street,"onUpdate:modelValue":l[8]||(l[8]=t=>e.address.street=t),label:"Rua",placeholder:"Digite a rua",required:"",error:s.address?.street},null,8,["modelValue","error"])]),r("div",le,[o(d,{modelValue:e.address.neighborhood,"onUpdate:modelValue":l[9]||(l[9]=t=>e.address.neighborhood=t),label:"Bairro",placeholder:"Digite o bairro",required:"",error:s.address?.neighborhood},null,8,["modelValue","error"]),r("div",null,[l[16]||(l[16]=r("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[u(" Estado "),r("span",{class:"text-red-500"},"*")],-1)),o(V,{modelValue:e.address.state,"onUpdate:modelValue":l[10]||(l[10]=t=>e.address.state=t),placeholder:"Selecione o estado",class:"w-full"},{default:i(()=>[(p(),m(F,null,O(N,t=>o(f,{key:t.value,label:t.label,value:t.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),s.address?.state?(p(),m("p",se,_(s.address.state),1)):x("",!0)])]),r("div",te,[o(d,{modelValue:e.address.city,"onUpdate:modelValue":l[11]||(l[11]=t=>e.address.city=t),label:"Cidade",placeholder:"Digite a cidade",required:"",error:s.address?.city},null,8,["modelValue","error"])])]),r("div",re,[o(b,{type:"button",variant:"outline",onClick:l[12]||(l[12]=t=>a.$router.push("/clients"))},{default:i(()=>l[18]||(l[18]=[u(" Cancelar ")])),_:1,__:[18]}),o(b,{type:"submit",loading:n.value},{default:i(()=>l[19]||(l[19]=[u(" Atualizar Cliente ")])),_:1,__:[19]},8,["loading"])])],32)]),_:1})])}}});export{me as default};
