import{d as w,E as z,r as c,a as b,R as N,c as f,e as o,f as d,w as m,_ as g,k as n,i as h,h as U,s as S,x as v}from"./index-D98dJrHF.js";import{V as k}from"./viacep-service-DXyPhLYe.js";import{_ as q}from"./BaseCard.vue_vue_type_script_setup_true_lang-COep7mP0.js";import{_ as i}from"./BaseInput.vue_vue_type_script_setup_true_lang-CYOYGt7K.js";const F={class:"space-y-6"},B={class:"md:flex md:items-center md:justify-between"},T={class:"mt-4 flex md:mt-0 md:ml-4"},A={class:"grid grid-cols-1 gap-6 sm:grid-cols-2"},M={class:"relative"},I={key:0,class:"absolute right-3 top-8"},j={key:0,class:"col-span-2"},L={class:"flex justify-end space-x-3"},G=w({__name:"ClientCreateView",setup(O){const C=S(),V=z(),p=c(!1),u=c(!1),t=c(!1),e=b({name:"",lastName:"",cpf:"",email:"",phone:"",status:N.ACTIVE,address:{zipCode:"",street:"",neighborhood:"",city:"",state:""}}),r=b({name:"",lastName:"",cpf:"",email:"",phone:"",cep:"",street:"",neighborhood:"",city:"",uf:""});function y(){Object.keys(r).forEach(a=>{r[a]=""});let l=!0;return e.name.trim()||(r.name="Nome é obrigatório",l=!1),e.lastName.trim()||(r.lastName="Sobrenome é obrigatório",l=!1),e.cpf.trim()?e.cpf.replace(/\D/g,"").length!==11?(r.cpf="CPF deve ter 11 dígitos",l=!1):e.cpf.length>14&&(r.cpf="CPF deve ter no máximo 14 caracteres",l=!1):(r.cpf="CPF é obrigatório",l=!1),e.email.trim()?/\S+@\S+\.\S+/.test(e.email)||(r.email="Email inválido",l=!1):(r.email="Email é obrigatório",l=!1),e.phone.trim()?e.phone.replace(/\D/g,"").length<10?(r.phone="Telefone deve ter pelo menos 10 dígitos",l=!1):e.phone.length>15&&(r.phone="Telefone deve ter no máximo 15 caracteres",l=!1):(r.phone="Telefone é obrigatório",l=!1),e.address.zipCode.trim()?e.address.zipCode.replace(/\D/g,"").length!==8?(r.cep="CEP deve ter 8 dígitos",l=!1):e.address.zipCode.length>9&&(r.cep="CEP deve ter no máximo 9 caracteres",l=!1):(r.cep="CEP é obrigatório",l=!1),e.address.street.trim()||(r.street=t.value?"Logradouro é obrigatório":"Digite um CEP válido para preencher o logradouro",l=!1),e.address.neighborhood.trim()||(r.neighborhood=t.value?"Bairro é obrigatório":"Digite um CEP válido para preencher o bairro",l=!1),e.address.city.trim()||(r.city=t.value?"Cidade é obrigatória":"Digite um CEP válido para preencher a cidade",l=!1),e.address.state.trim()||(r.uf=t.value?"UF é obrigatória":"Digite um CEP válido para preencher a UF",l=!1),l}async function x(){if(y())try{p.value=!0,await V.createClient(e)&&await C.push("/clients")}catch(l){console.error("Erro ao criar cliente:",l)}finally{p.value=!1}}function E(){let l=e.cpf.replace(/\D/g,"");l=l.substring(0,11),l=l.replace(/(\d{3})(\d)/,"$1.$2"),l=l.replace(/(\d{3})(\d)/,"$1.$2"),l=l.replace(/(\d{3})(\d{1,2})$/,"$1-$2"),e.cpf=l}function P(){let l=e.phone.replace(/\D/g,"");l=l.substring(0,11),l=l.replace(/(\d{2})(\d)/,"($1) $2"),l=l.replace(/(\d{5})(\d)/,"$1-$2"),e.phone=l}function $(){let l=e.address.zipCode.replace(/\D/g,"");l=l.substring(0,8),l=l.replace(/(\d{5})(\d)/,"$1-$2"),e.address.zipCode=l,l.length<9&&(t.value=!1)}async function D(){if(e.address.zipCode.replace(/\D/g,"").length===8)try{u.value=!0,t.value=!1;const l=await k.getAddressByZipCode(e.address.zipCode);l?(e.address.street=l.street,e.address.neighborhood=l.neighborhood,e.address.city=l.city,e.address.state=l.state,t.value=!1):(e.address.street="",e.address.neighborhood="",e.address.city="",e.address.state="",t.value=!0)}catch(l){console.error("Erro ao buscar endereço:",l),e.address.street="",e.address.neighborhood="",e.address.city="",e.address.state="",t.value=!0}finally{u.value=!1}else t.value=!1}return(l,a)=>(v(),f("div",F,[o("div",B,[a[13]||(a[13]=o("div",{class:"flex-1 min-w-0"},[o("h2",{class:"text-2xl font-bold leading-7 text-gray-900 sm:text-3xl sm:truncate"}," Criar Novo Cliente "),o("p",{class:"mt-1 text-sm text-gray-500"}," Adicione um novo cliente ao sistema com informações de contato e endereço. ")],-1)),o("div",T,[d(g,{variant:"outline",onClick:a[0]||(a[0]=s=>l.$router.push("/clients"))},{default:m(()=>a[12]||(a[12]=[n(" Voltar ")])),_:1,__:[12]})])]),d(q,null,{default:m(()=>[o("form",{onSubmit:U(x,["prevent"]),class:"space-y-6"},[o("div",A,[a[16]||(a[16]=o("div",{class:"col-span-2"},[o("div",{class:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4"},[o("div",{class:"flex items-start"},[o("div",{class:"flex-shrink-0"},[o("svg",{class:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor"},[o("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"})])]),o("div",{class:"ml-3"},[o("p",{class:"text-sm text-blue-700"},[o("strong",null,"Dica:"),n(" Digite o CEP para preenchimento automático do endereço. Os campos de endereço serão preenchidos automaticamente. ")])])])])],-1)),d(i,{id:"name",modelValue:e.name,"onUpdate:modelValue":a[1]||(a[1]=s=>e.name=s),label:"Nome",placeholder:"Digite o nome",required:"",error:r.name},null,8,["modelValue","error"]),d(i,{id:"lastName",modelValue:e.lastName,"onUpdate:modelValue":a[2]||(a[2]=s=>e.lastName=s),label:"Sobrenome",placeholder:"Digite o sobrenome",required:"",error:r.lastName},null,8,["modelValue","error"]),d(i,{id:"cpf",modelValue:e.cpf,"onUpdate:modelValue":a[3]||(a[3]=s=>e.cpf=s),label:"CPF",placeholder:"000.000.000-00",required:"",error:r.cpf,onInput:E},null,8,["modelValue","error"]),d(i,{id:"email",modelValue:e.email,"onUpdate:modelValue":a[4]||(a[4]=s=>e.email=s),type:"email",label:"Email",placeholder:"cliente@email.com",required:"",error:r.email},null,8,["modelValue","error"]),d(i,{id:"phone",modelValue:e.phone,"onUpdate:modelValue":a[5]||(a[5]=s=>e.phone=s),label:"Telefone",placeholder:"(11) 99999-9999",required:"",error:r.phone,onInput:P},null,8,["modelValue","error"]),o("div",M,[d(i,{id:"zipCode",modelValue:e.address.zipCode,"onUpdate:modelValue":a[6]||(a[6]=s=>e.address.zipCode=s),label:"CEP",placeholder:"00000-000",required:"",error:r.cep,onInput:$,onBlur:D,loading:u.value},null,8,["modelValue","error","loading"]),u.value?(v(),f("div",I,a[14]||(a[14]=[o("div",{class:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"},null,-1)]))):h("",!0)]),t.value?(v(),f("div",j,a[15]||(a[15]=[o("div",{class:"bg-yellow-50 border border-yellow-200 rounded-lg p-3"},[o("div",{class:"flex items-start"},[o("div",{class:"flex-shrink-0"},[o("svg",{class:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor"},[o("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})])]),o("div",{class:"ml-3"},[o("p",{class:"text-sm text-yellow-700"},[o("strong",null,"Atenção:"),n(" CEP não encontrado. Os campos de endereço foram liberados para edição manual. ")])])])],-1)]))):h("",!0),d(i,{id:"street",modelValue:e.address.street,"onUpdate:modelValue":a[7]||(a[7]=s=>e.address.street=s),label:"Logradouro",placeholder:t.value?"Digite o logradouro":"Preenchido automaticamente pelo CEP",required:"",error:r.street,disabled:!t.value},null,8,["modelValue","placeholder","error","disabled"]),d(i,{id:"neighborhood",modelValue:e.address.neighborhood,"onUpdate:modelValue":a[8]||(a[8]=s=>e.address.neighborhood=s),label:"Bairro",placeholder:t.value?"Digite o bairro":"Preenchido automaticamente pelo CEP",required:"",error:r.neighborhood,disabled:!t.value},null,8,["modelValue","placeholder","error","disabled"]),d(i,{id:"city",modelValue:e.address.city,"onUpdate:modelValue":a[9]||(a[9]=s=>e.address.city=s),label:"Cidade",placeholder:t.value?"Digite a cidade":"Preenchido automaticamente pelo CEP",required:"",error:r.city,disabled:!t.value},null,8,["modelValue","placeholder","error","disabled"]),d(i,{id:"state",modelValue:e.address.state,"onUpdate:modelValue":a[10]||(a[10]=s=>e.address.state=s),label:"UF",placeholder:t.value?"Digite a UF":"Preenchido automaticamente pelo CEP",required:"",error:r.uf,maxlength:"2",disabled:!t.value},null,8,["modelValue","placeholder","error","disabled"])]),o("div",L,[d(g,{type:"button",variant:"outline",onClick:a[11]||(a[11]=s=>l.$router.push("/clients"))},{default:m(()=>a[17]||(a[17]=[n(" Cancelar ")])),_:1,__:[17]}),d(g,{type:"submit",loading:p.value},{default:m(()=>a[18]||(a[18]=[n(" Criar Cliente ")])),_:1,__:[18]},8,["loading"])])],32)]),_:1})]))}});export{G as default};
