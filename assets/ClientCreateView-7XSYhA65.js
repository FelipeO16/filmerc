import{K as z,d as N,m as U,r as g,a as C,J as F,c as v,b as o,e as d,w as f,_ as b,j as p,E as V,i as S,k,o as h}from"./index-CQ0vSrWa.js";import{_ as q}from"./BaseCard.vue_vue_type_script_setup_true_lang-B-bdGHi1.js";import{_ as u}from"./BaseInput.vue_vue_type_script_setup_true_lang-A9umqBxa.js";class B{static async getAddressByZipCode(m){try{const i=m.replace(/\D/g,"");if(i.length!==8)throw new Error("Formato de CEP inválido");const n=await z.get(`/${i}/json/`);return n.data.erro?null:{zipCode:n.data.cep,street:n.data.logradouro,neighborhood:n.data.bairro,city:n.data.localidade,state:n.data.uf}}catch(i){return console.error("Erro ao buscar endereço do ViaCEP:",i),null}}static formatZipCode(m){const i=m.replace(/\D/g,"");return i.length===8?`${i.slice(0,5)}-${i.slice(5)}`:m}static isValidZipCode(m){return m.replace(/\D/g,"").length===8}}const Z={class:"space-y-6"},A={class:"md:flex md:items-center md:justify-between"},T={class:"mt-4 flex md:mt-0 md:ml-4"},j={class:"grid grid-cols-1 gap-6 sm:grid-cols-2"},M={class:"relative"},I={key:0,class:"absolute right-3 top-8"},L={key:0,class:"col-span-2"},O={class:"flex justify-end space-x-3"},K=N({__name:"ClientCreateView",setup(y){const m=k(),i=U(),n=g(!1),c=g(!1),s=g(!1),e=C({name:"",lastName:"",cpf:"",email:"",phone:"",status:F.ACTIVE,address:{zipCode:"",street:"",neighborhood:"",city:"",state:""}}),l=C({name:"",lastName:"",cpf:"",email:"",phone:"",cep:"",street:"",neighborhood:"",city:"",uf:""});function x(){Object.keys(l).forEach(r=>{l[r]=""});let a=!0;return e.name.trim()||(l.name="Nome é obrigatório",a=!1),e.lastName.trim()||(l.lastName="Sobrenome é obrigatório",a=!1),e.cpf.trim()?e.cpf.replace(/\D/g,"").length!==11?(l.cpf="CPF deve ter 11 dígitos",a=!1):e.cpf.length>14&&(l.cpf="CPF deve ter no máximo 14 caracteres",a=!1):(l.cpf="CPF é obrigatório",a=!1),e.email.trim()?/\S+@\S+\.\S+/.test(e.email)||(l.email="Email inválido",a=!1):(l.email="Email é obrigatório",a=!1),e.phone.trim()?e.phone.replace(/\D/g,"").length<10?(l.phone="Telefone deve ter pelo menos 10 dígitos",a=!1):e.phone.length>15&&(l.phone="Telefone deve ter no máximo 15 caracteres",a=!1):(l.phone="Telefone é obrigatório",a=!1),e.address.zipCode.trim()?e.address.zipCode.replace(/\D/g,"").length!==8?(l.cep="CEP deve ter 8 dígitos",a=!1):e.address.zipCode.length>9&&(l.cep="CEP deve ter no máximo 9 caracteres",a=!1):(l.cep="CEP é obrigatório",a=!1),e.address.street.trim()||(l.street=s.value?"Logradouro é obrigatório":"Digite um CEP válido para preencher o logradouro",a=!1),e.address.neighborhood.trim()||(l.neighborhood=s.value?"Bairro é obrigatório":"Digite um CEP válido para preencher o bairro",a=!1),e.address.city.trim()||(l.city=s.value?"Cidade é obrigatória":"Digite um CEP válido para preencher a cidade",a=!1),e.address.state.trim()||(l.uf=s.value?"UF é obrigatória":"Digite um CEP válido para preencher a UF",a=!1),a}async function E(){if(x())try{n.value=!0,await i.createClient(e)&&await m.push("/clients")}catch(a){console.error("Erro ao criar cliente:",a)}finally{n.value=!1}}function P(){let a=e.cpf.replace(/\D/g,"");a=a.substring(0,11),a=a.replace(/(\d{3})(\d)/,"$1.$2"),a=a.replace(/(\d{3})(\d)/,"$1.$2"),a=a.replace(/(\d{3})(\d{1,2})$/,"$1-$2"),e.cpf=a}function $(){let a=e.phone.replace(/\D/g,"");a=a.substring(0,11),a=a.replace(/(\d{2})(\d)/,"($1) $2"),a=a.replace(/(\d{5})(\d)/,"$1-$2"),e.phone=a}function D(){let a=e.address.zipCode.replace(/\D/g,"");a=a.substring(0,8),a=a.replace(/(\d{5})(\d)/,"$1-$2"),e.address.zipCode=a,a.length<9&&(s.value=!1)}async function w(){if(e.address.zipCode.replace(/\D/g,"").length===8)try{c.value=!0,s.value=!1;const a=await B.getAddressByZipCode(e.address.zipCode);a?(e.address.street=a.street,e.address.neighborhood=a.neighborhood,e.address.city=a.city,e.address.state=a.state,s.value=!1):(e.address.street="",e.address.neighborhood="",e.address.city="",e.address.state="",s.value=!0)}catch(a){console.error("Erro ao buscar endereço:",a),e.address.street="",e.address.neighborhood="",e.address.city="",e.address.state="",s.value=!0}finally{c.value=!1}else s.value=!1}return(a,r)=>(h(),v("div",Z,[o("div",A,[r[13]||(r[13]=o("div",{class:"flex-1 min-w-0"},[o("h2",{class:"text-2xl font-bold leading-7 text-gray-900 sm:text-3xl sm:truncate"}," Criar Novo Cliente "),o("p",{class:"mt-1 text-sm text-gray-500"}," Adicione um novo cliente ao sistema com informações de contato e endereço. ")],-1)),o("div",T,[d(b,{variant:"outline",onClick:r[0]||(r[0]=t=>a.$router.push("/clients"))},{default:f(()=>r[12]||(r[12]=[p(" Voltar ")])),_:1,__:[12]})])]),d(q,null,{default:f(()=>[o("form",{onSubmit:S(E,["prevent"]),class:"space-y-6"},[o("div",j,[r[16]||(r[16]=o("div",{class:"col-span-2"},[o("div",{class:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4"},[o("div",{class:"flex items-start"},[o("div",{class:"flex-shrink-0"},[o("svg",{class:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor"},[o("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"})])]),o("div",{class:"ml-3"},[o("p",{class:"text-sm text-blue-700"},[o("strong",null,"Dica:"),p(" Digite o CEP para preenchimento automático do endereço. Os campos de endereço serão preenchidos automaticamente. ")])])])])],-1)),d(u,{id:"name",modelValue:e.name,"onUpdate:modelValue":r[1]||(r[1]=t=>e.name=t),label:"Nome",placeholder:"Digite o nome",required:"",error:l.name},null,8,["modelValue","error"]),d(u,{id:"lastName",modelValue:e.lastName,"onUpdate:modelValue":r[2]||(r[2]=t=>e.lastName=t),label:"Sobrenome",placeholder:"Digite o sobrenome",required:"",error:l.lastName},null,8,["modelValue","error"]),d(u,{id:"cpf",modelValue:e.cpf,"onUpdate:modelValue":r[3]||(r[3]=t=>e.cpf=t),label:"CPF",placeholder:"000.000.000-00",required:"",error:l.cpf,onInput:P},null,8,["modelValue","error"]),d(u,{id:"email",modelValue:e.email,"onUpdate:modelValue":r[4]||(r[4]=t=>e.email=t),type:"email",label:"Email",placeholder:"cliente@email.com",required:"",error:l.email},null,8,["modelValue","error"]),d(u,{id:"phone",modelValue:e.phone,"onUpdate:modelValue":r[5]||(r[5]=t=>e.phone=t),label:"Telefone",placeholder:"(11) 99999-9999",required:"",error:l.phone,onInput:$},null,8,["modelValue","error"]),o("div",M,[d(u,{id:"zipCode",modelValue:e.address.zipCode,"onUpdate:modelValue":r[6]||(r[6]=t=>e.address.zipCode=t),label:"CEP",placeholder:"00000-000",required:"",error:l.cep,onInput:D,onBlur:w,loading:c.value},null,8,["modelValue","error","loading"]),c.value?(h(),v("div",I,r[14]||(r[14]=[o("div",{class:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"},null,-1)]))):V("",!0)]),s.value?(h(),v("div",L,r[15]||(r[15]=[o("div",{class:"bg-yellow-50 border border-yellow-200 rounded-lg p-3"},[o("div",{class:"flex items-start"},[o("div",{class:"flex-shrink-0"},[o("svg",{class:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor"},[o("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})])]),o("div",{class:"ml-3"},[o("p",{class:"text-sm text-yellow-700"},[o("strong",null,"Atenção:"),p(" CEP não encontrado. Os campos de endereço foram liberados para edição manual. ")])])])],-1)]))):V("",!0),d(u,{id:"street",modelValue:e.address.street,"onUpdate:modelValue":r[7]||(r[7]=t=>e.address.street=t),label:"Logradouro",placeholder:s.value?"Digite o logradouro":"Preenchido automaticamente pelo CEP",required:"",error:l.street,disabled:!s.value},null,8,["modelValue","placeholder","error","disabled"]),d(u,{id:"neighborhood",modelValue:e.address.neighborhood,"onUpdate:modelValue":r[8]||(r[8]=t=>e.address.neighborhood=t),label:"Bairro",placeholder:s.value?"Digite o bairro":"Preenchido automaticamente pelo CEP",required:"",error:l.neighborhood,disabled:!s.value},null,8,["modelValue","placeholder","error","disabled"]),d(u,{id:"city",modelValue:e.address.city,"onUpdate:modelValue":r[9]||(r[9]=t=>e.address.city=t),label:"Cidade",placeholder:s.value?"Digite a cidade":"Preenchido automaticamente pelo CEP",required:"",error:l.city,disabled:!s.value},null,8,["modelValue","placeholder","error","disabled"]),d(u,{id:"state",modelValue:e.address.state,"onUpdate:modelValue":r[10]||(r[10]=t=>e.address.state=t),label:"UF",placeholder:s.value?"Digite a UF":"Preenchido automaticamente pelo CEP",required:"",error:l.uf,maxlength:"2",disabled:!s.value},null,8,["modelValue","placeholder","error","disabled"])]),o("div",O,[d(b,{type:"button",variant:"outline",onClick:r[11]||(r[11]=t=>a.$router.push("/clients"))},{default:f(()=>r[17]||(r[17]=[p(" Cancelar ")])),_:1,__:[17]}),d(b,{type:"submit",loading:n.value},{default:f(()=>r[18]||(r[18]=[p(" Criar Cliente ")])),_:1,__:[18]},8,["loading"])])],32)]),_:1})]))}});export{K as default};
